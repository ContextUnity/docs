---
title: ContextRouter
description: AI Gateway and Agent Orchestration — LangGraph, LLM routing, tool dispatch.
---

import { Card, CardGrid } from '@astrojs/starlight/components';

ContextRouter is the **"Mind"** of the ContextUnity ecosystem. It receives requests from various protocols (Telegram, Web, API), orchestrates LangGraph agents, routes to LLM providers, and delegates memory to Brain.

<CardGrid>
  <Card title="Agent Orchestration" icon="rocket">
    LangGraph state machines for complex multi-step reasoning workflows with full provenance tracking.
  </Card>
  <Card title="LLM Provider Routing" icon="random">
    13 LLM providers with automatic fallback: OpenAI, Anthropic, Vertex AI, Groq, Perplexity, and more.
  </Card>
  <Card title="Tool Integration" icon="puzzle">
    Exposes Brain (search), Commerce (products), and custom tools for LLM function calling.
  </Card>
  <Card title="Observability" icon="eye">
    Full OpenTelemetry tracing and Langfuse integration for agent step visibility.
  </Card>
</CardGrid>

## Architecture

```
src/contextrouter/
├── modules/                      # Capability modules
│   ├── models/                   # LLM providers (13 backends)
│   │   ├── registry.py           # Model registry with fallback
│   │   ├── llm/
│   │   │   ├── openai.py         # OpenAI (GPT-5, o1, o3)
│   │   │   ├── anthropic.py      # Anthropic (Claude Sonnet/Haiku)
│   │   │   ├── vertex.py         # Google Vertex AI (Gemini 2.x)
│   │   │   ├── perplexity.py     # Perplexity (Sonar)
│   │   │   ├── groq.py           # Groq (ultra-fast Llama)
│   │   │   ├── rlm.py            # RLM (Recursive Language Model)
│   │   │   └── ...               # HuggingFace, OpenRouter, LiteLLM, etc.
│   │   └── embeddings/           # Embedding providers
│   ├── connectors/               # Data source connectors (Web, RSS, API, File)
│   ├── transformers/             # NER, taxonomy, summarization, ontology
│   ├── providers/storage/        # Brain, Postgres, Vertex, GCS
│   ├── tools/                    # LLM tool registry
│   ├── retrieval/rag/            # RAG pipeline
│   └── observability/            # OpenTelemetry tracing
│
├── cortex/                       # AI orchestration core
│   ├── graphs/                   # LangGraph agent definitions
│   │   ├── dispatcher.py         # Central graph router
│   │   ├── rag_retrieval/        # RAG pipeline graph
│   │   ├── commerce/gardener/    # Taxonomy classifier
│   │   ├── commerce/matcher/     # Product linking (RLM-based)
│   │   ├── news_engine/          # Multi-stage news pipeline
│   │   └── analytics/            # Data analytics graphs
│   ├── services/graph/           # Graph execution service
│   ├── subagents/                # Sub-agent orchestration
│   ├── prompting/                # Prompt templates
│   └── runners/                  # Stream/invoke helpers
│
├── core/                         # Configuration, registry, plugins
│   ├── registry.py               # Module registry
│   ├── plugins.py                # Plugin architecture
│   ├── interfaces.py             # Base classes for Connector/Transformer/Provider
│   ├── memory.py                 # Agent memory management
│   └── tokens.py                 # Token utilities
│
├── service/                      # gRPC service
│   ├── server.py                 # gRPC server setup
│   ├── dispatcher_service.py     # Dispatcher RPC handler
│   ├── stream_executors.py       # Bi-directional stream handling
│   └── security.py               # Shield client integration
│
├── api/                          # REST/protocol adapters
└── cli/                          # CLI utilities
```

## Links

- [Agent Orchestration](/router/agents/) — LangGraph graphs and Cortex pipeline
- [Dispatcher & Security](/router/dispatcher/) — gRPC service and token validation
- [Cortex Pipeline](/router/cortex/) — RAG retrieval, intent detection, generation
- [Tool System](/router/tools/) — Tool registration and bi-directional streams
- [Configuration](/router/configuration/) — Environment variables and settings
- [GitHub Repository](https://github.com/ContextUnity/contextrouter)
